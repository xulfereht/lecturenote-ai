# LectureNote AI 품질 개선 계획 v3

## 🎯 최우선 목표
**"시간 비례 분량 + 학습자 친화적 형식"**

---

## 📊 문제점 분석

### 1. 분량 불균형 문제
| 문제 | 원인 | 해결 방향 |
|------|------|----------|
| 30분 섹션 = 5분 섹션 분량 | 시간 정보 미활용 | 시간 비례 토큰 요청 |
| 긴 섹션 과도 요약 | 고정 길이 요청 | 동적 길이 계산 |

### 2. 형식 일관성 문제
| 문제 | 원인 | 해결 방향 |
|------|------|----------|
| 섹션별 깊이 불균형 | 모호한 프롬프트 | 명확한 규칙 수립 |
| 서브섹션 과잉/부족 | AI 재량에 의존 | 구조 템플릿 고정 |

### 3. 형식 만족도 문제
| 문제 | 원인 | 해결 방향 |
|------|------|----------|
| 요약문 느낌 | 스토리텔링 부족 | 내러티브 강화 |
| 학습 활용 어려움 | 실용적 요소 부족 | 복습/실습 요소 추가 |

---

## 🔧 구체적 개선 방안

### Phase 1: 시간 비례 분량 시스템

#### 1.1 시간 정보 계산
```javascript
// 챕터별 시간(분) 계산
const chapterDuration = (endTime - startTime) / 60;

// 기준: 10분당 약 400자
const targetLength = Math.max(400, chapterDuration * 40);
```

#### 1.2 프롬프트에 분량 지시
```
이 섹션은 ${duration}분 분량입니다.
최소 ${targetLength}자 이상의 상세한 노트를 작성하세요.

- 10분 미만: 300-500자 (핵심만)
- 10-20분: 600-1000자 (적당히 상세)
- 20-40분: 1200-2000자 (상세히)
- 40분 이상: 2000자+ (매우 상세히)
```

### Phase 2: 새로운 노트 형식

#### 2.1 "코넬 노트" 스타일 적용
```
┌─────────────────────────────────────────┐
│  [챕터 제목]           시간: 00:00-12:30 │
├─────────────┬───────────────────────────┤
│  핵심 키워드 │  본문 (스토리텔링)        │
│             │                           │
│  • 개념 A   │  강의자는 먼저 개념 A를   │
│  • 개념 B   │  설명하며...              │
│  • 원리 C   │                           │
│             │  이어서 개념 B와의 관계를  │
│             │  언급하며...              │
├─────────────┴───────────────────────────┤
│  💡 요약: 한 줄로 정리하면...            │
├─────────────────────────────────────────┤
│  ✅ 복습 질문:                           │
│  1. 개념 A와 B의 차이점은?               │
│  2. 원리 C를 실제로 적용하려면?          │
└─────────────────────────────────────────┘
```

#### 2.2 새로운 스키마 구조
```javascript
{
  // 상단: 메타 정보
  chapterTitle: String,
  duration: Number,  // 분
  keyMessage: String,  // 한 줄 핵심 메시지
  
  // 좌측: 핵심 구조
  outline: [
    { keyword: "개념A", brief: "짧은 설명" }
  ],
  
  // 우측: 본문 (시간 비례 상세 내러티브)
  narrative: String,  // 마크다운, 시간 비례 분량
  
  // 하단: 학습 보조
  summary: String,  // 2-3문장 요약
  reviewQuestions: [String],  // 복습 질문 2-3개
  actionItems: [String],  // 실천 항목 (있다면)
  
  // 부가: 참조
  keyTerms: [{ term, definition }],  // 용어 정리
  warnings: [String],  // 주의사항 (있다면)
}
```

### Phase 3: 프롬프트 재설계

#### 3.1 초기 스캔 프롬프트
```
강의를 분석하여 챕터를 나누세요.

## 챕터 분리 기준:
1. 주제 전환 시점 (새로운 개념 도입)
2. 15-30분 단위로 자연스럽게 분리
3. 너무 짧은 챕터(5분 미만)는 합치기
4. 너무 긴 챕터(40분 이상)는 나누기

## 각 챕터에 포함할 정보:
- startTime, endTime (정확한 시간)
- 핵심 키워드 3-5개
- 예상 분량 가이드라인
```

#### 3.2 딥다이브 프롬프트
```
당신은 전문 강의 필기사입니다.

## 이 챕터 정보
- 제목: ${title}
- 시간: ${startTime} ~ ${endTime} (${duration}분)
- 키워드: ${keywords}

## 핵심 지침
1. **분량**: 이 섹션은 ${duration}분입니다. 최소 ${targetLength}자 노트 작성
2. **형식**: 스토리텔링 내러티브 + 키워드 아웃라인 병행
3. **내용**: 
   - 강의자의 설명 흐름을 따라가며 작성
   - 예시와 비유 반드시 포함
   - "~라고 했다", "~를 강조했다" 형태 사용
4. **학습 요소**: 복습 질문 2-3개 생성

## 작성 예시
"강의자는 먼저 OOO 개념을 소개하며, 이것이 왜 중요한지 실제 사례를 들어 설명했다. 
'XXX'라는 예시를 통해...(중략)...결론적으로 OOO는 △△△와 연결된다고 정리했다."
```

---

## 📈 우선순위

### P0 (즉시 구현)
1. ✅ 시간 비례 분량 계산 로직 추가
2. ✅ 프롬프트에 분량 지시 포함
3. ✅ 딥다이브 프롬프트 개선

### P1 (이번 주 내)
4. 🔲 새로운 스키마 구조 적용
5. 🔲 PDF 레이아웃을 새 형식에 맞게 재설계
6. 🔲 복습 질문 생성 기능 추가

### P2 (다음 단계)
7. 🔲 코넬 노트 스타일 UI 적용
8. 🔲 용어집 자동 생성
9. 🔲 챕터 간 연결 관계 시각화

---

## 🎯 성공 지표

| 지표 | 현재 | 목표 |
|------|------|------|
| 분량 비례 정확도 | 0% (무관) | 80%+ |
| 내러티브 자연스러움 | 보통 | 높음 |
| 복습 활용도 | 낮음 | 높음 |
| PDF 가독성 | 보통 | 높음 |

---

## 다음 단계
P0 항목부터 즉시 구현을 시작합니다.
